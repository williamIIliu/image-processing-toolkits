# å›¾ç‰‡å¤„ç† MCP æœåŠ¡å™¨

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å›¾ç‰‡å¤„ç†MCP (Model Context Protocol) æœåŠ¡å™¨ï¼Œæä¾›äº†ä¸°å¯Œçš„å›¾ç‰‡å¤„ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬è£å‰ªã€æ—‹è½¬ã€è°ƒæ•´å¤§å°ã€å¯¹æ¯”åº¦è°ƒæ•´ç­‰ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ðŸŽ¨ åŸºç¡€å›¾ç‰‡å¤„ç†
- **è£å‰ªå›¾ç‰‡** - ç²¾ç¡®è£å‰ªåˆ°æŒ‡å®šåŒºåŸŸ
- **æ—‹è½¬å›¾ç‰‡** - ä»»æ„è§’åº¦æ—‹è½¬ï¼Œæ”¯æŒç”»å¸ƒæ‰©å±•
- **è°ƒæ•´å¤§å°** - æ™ºèƒ½ç¼©æ”¾ï¼Œå¯ä¿æŒå®½é«˜æ¯”
- **ç¿»è½¬å›¾ç‰‡** - æ°´å¹³æˆ–åž‚ç›´ç¿»è½¬

### ðŸŒˆ å›¾ç‰‡å¢žå¼º
- **å¯¹æ¯”åº¦è°ƒæ•´** - å¢žå¼ºæˆ–å‡å¼±å›¾ç‰‡å¯¹æ¯”åº¦
- **äº®åº¦è°ƒæ•´** - è°ƒèŠ‚å›¾ç‰‡æ˜Žæš—ç¨‹åº¦
- **é¥±å’Œåº¦è°ƒæ•´** - æŽ§åˆ¶è‰²å½©é¥±å’Œåº¦ï¼Œæ”¯æŒç°åº¦è½¬æ¢

### ðŸŽ­ æ»¤é•œæ•ˆæžœ
- **æ¨¡ç³Šæ•ˆæžœ** (BLUR)
- **ç»†èŠ‚å¢žå¼º** (DETAIL)
- **è¾¹ç¼˜å¢žå¼º** (EDGE_ENHANCE, EDGE_ENHANCE_MORE)
- **æµ®é›•æ•ˆæžœ** (EMBOSS)
- **è¾¹ç¼˜æ£€æµ‹** (FIND_EDGES)
- **é”åŒ–** (SHARPEN)
- **å¹³æ»‘** (SMOOTH, SMOOTH_MORE)

### ðŸ”§ å®žç”¨å·¥å…·
- **æ ¼å¼è½¬æ¢** - æ”¯æŒ JPEG, PNG, BMP, TIFF, WEBP
- **ç¼©ç•¥å›¾ç”Ÿæˆ** - å¿«é€Ÿç”ŸæˆæŒ‡å®šå°ºå¯¸ç¼©ç•¥å›¾
- **æ°´å°æ·»åŠ ** - æ–‡å­—æ°´å°ï¼Œæ”¯æŒå¤šç§ä½ç½®å’Œé€æ˜Žåº¦
- **å›¾ç‰‡ä¿¡æ¯èŽ·å–** - è¯¦ç»†çš„å…ƒæ•°æ®å’ŒEXIFä¿¡æ¯

### âš¡ æ€§èƒ½ä¼˜åŒ–
- **æ™ºèƒ½ç¼“å­˜** - è‡ªåŠ¨ç¼“å­˜å¸¸ç”¨å›¾ç‰‡ï¼Œæå‡å¤„ç†é€Ÿåº¦
- **å†…å­˜ç®¡ç†** - ç›‘æŽ§å†…å­˜ä½¿ç”¨ï¼Œè‡ªåŠ¨æ¸…ç†è¿‡æœŸç¼“å­˜
- **å¹¶å‘å¤„ç†** - æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘å¤„ç†
- **é”™è¯¯å¤„ç†** - å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶

## å®‰è£…å’Œé…ç½®

### 1. å®‰è£…ä¾èµ–

åœ¨ä½¿ç”¨å›¾ç‰‡å¤„ç†æœåŠ¡å™¨ä¹‹å‰ï¼Œéœ€è¦å®‰è£…ä»¥ä¸‹ä¾èµ–åŒ…ï¼š

```bash
pip install Pillow opencv-python numpy psutil mcp[cli]
```

æˆ–è€…ä½¿ç”¨é¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼š

```bash
pip install -r requirements.txt
```

**æ³¨æ„**: å¿…é¡»å®‰è£… `mcp[cli]` è€Œä¸æ˜¯å•ç‹¬çš„ `mcp`ï¼Œè¿™æ ·æ‰èƒ½åŒ…å«æ‰€éœ€çš„ CLI å·¥å…·å’Œä¾èµ–ï¼ˆå¦‚ typerï¼‰ã€‚

### 2. MCP Server é…ç½®

è¦åœ¨æ”¯æŒMCPçš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨æ­¤å›¾åƒå¤„ç†æœåŠ¡å™¨ï¼Œè¯·å°†ä»¥ä¸‹é…ç½®æ·»åŠ åˆ°æ‚¨çš„MCPé…ç½®æ–‡ä»¶ä¸­ï¼š

#### Claude Desktop é…ç½®
åœ¨ `%APPDATA%\Claude\claude_desktop_config.json` (Windows) æˆ– `~/Library/Application Support/Claude/claude_desktop_config.json` (macOS) ä¸­æ·»åŠ ï¼š

```json
{
    "mcpServers": {
        "image_processing_toolkits": {
            "command": "python",
            "args": [
                "e:/MyProjects/TOBench/server_tools/local_servers/image-processing-toolkits/src/server.py"
            ],
            "cwd": "e:/MyProjects/TOBench/server_tools/local_servers/image-processing-toolkits"
        }
    }
}
```

#### ä½¿ç”¨ uv è¿è¡Œå™¨çš„é…ç½®
å¦‚æžœæ‚¨ä½¿ç”¨ uv ä½œä¸º Python åŒ…ç®¡ç†å™¨ï¼š

```json
{
    "mcpServers": {
        "image_processing_toolkits": {
            "command": "uv",
            "args": [
                "--directory",
                "e:/MyProjects/TOBench/server_tools/local_servers/image-processing-toolkits",
                "run",
                "python",
                "src/server.py"
            ]
        }
    }
}
```

#### é€šç”¨é…ç½®æ¨¡æ¿
è¯·å°†è·¯å¾„æ›¿æ¢ä¸ºæ‚¨çš„å®žé™…å®‰è£…è·¯å¾„ï¼š

```json
{
    "mcpServers": {
        "image_processing_toolkits": {
            "command": "python",
            "args": [
                "/path/to/image-processing-toolkits/src/server.py"
            ],
            "cwd": "/path/to/image-processing-toolkits"
        }
    }
}
```

#### FastMCP ç‰¹æ€§
æœ¬æœåŠ¡å™¨ä½¿ç”¨ **FastMCP** æ¡†æž¶æž„å»ºï¼Œæä¾›ä»¥ä¸‹ä¼˜åŠ¿ï¼š
- **ç®€åŒ–çš„å·¥å…·å®šä¹‰**: ä½¿ç”¨ `@mcp.tool()` è£…é¥°å™¨ç›´æŽ¥å®šä¹‰å·¥å…·
- **è‡ªåŠ¨ç±»åž‹æŽ¨æ–­**: ä»Žå‡½æ•°ç­¾åè‡ªåŠ¨ç”Ÿæˆå·¥å…·æ¨¡å¼
- **æ›´å°‘çš„æ ·æ¿ä»£ç **: æ— éœ€æ‰‹åŠ¨å®šä¹‰å¤æ‚çš„å·¥å…·åˆ—è¡¨å’Œå¤„ç†å™¨
- **æ›´å¥½çš„å¼€å‘ä½“éªŒ**: ä¸“æ³¨äºŽä¸šåŠ¡é€»è¾‘è€Œéžåè®®ç»†èŠ‚
- **è‡ªåŠ¨æ–‡æ¡£ç”Ÿæˆ**: ä»Žå‡½æ•°docstringè‡ªåŠ¨ç”Ÿæˆå·¥å…·æè¿°

### 3. å¯åŠ¨æœåŠ¡å™¨

#### ç›´æŽ¥å¯åŠ¨
```bash
python src/server.py
```

#### ä½¿ç”¨ uv å¯åŠ¨
```bash
uv run python src/server.py
```

### 4. éªŒè¯å®‰è£…

å¯åŠ¨æœåŠ¡å™¨åŽï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ä»¥ä¸‹æ¶ˆæ¯ï¼š
```
Image Processing MCP Server starting...
```

å¦‚æžœé…ç½®æ­£ç¡®ï¼ŒMCPå®¢æˆ·ç«¯å°†èƒ½å¤Ÿå‘çŽ°å¹¶ä½¿ç”¨æ‰€æœ‰12ä¸ªå›¾åƒå¤„ç†å·¥å…·ã€‚

## å¯ç”¨å·¥å…·

### 1. crop-image - è£å‰ªå›¾ç‰‡
```json
{
  "file_path": "path/to/image.jpg",
  "x": 100,
  "y": 100,
  "width": 200,
  "height": 150,
  "output_path": "path/to/cropped.jpg"  // å¯é€‰
}
```

### 2. rotate-image - æ—‹è½¬å›¾ç‰‡
```json
{
  "file_path": "path/to/image.jpg",
  "angle": 45,
  "expand": true,  // æ˜¯å¦æ‰©å±•ç”»å¸ƒ
  "output_path": "path/to/rotated.jpg"  // å¯é€‰
}
```

### 3. resize-image - è°ƒæ•´å¤§å°
```json
{
  "file_path": "path/to/image.jpg",
  "width": 800,
  "height": 600,
  "maintain_aspect": true,  // ä¿æŒå®½é«˜æ¯”
  "resample": "LANCZOS",    // LANCZOS, BILINEAR, BICUBIC, NEAREST
  "output_path": "path/to/resized.jpg"  // å¯é€‰
}
```

### 4. adjust-contrast - è°ƒæ•´å¯¹æ¯”åº¦
```json
{
  "file_path": "path/to/image.jpg",
  "factor": 1.5,  // >1å¢žå¼º, <1å‡å¼±, 1.0åŽŸå§‹
  "output_path": "path/to/contrast.jpg"  // å¯é€‰
}
```

### 5. adjust-brightness - è°ƒæ•´äº®åº¦
```json
{
  "file_path": "path/to/image.jpg",
  "factor": 1.2,  // >1å¢žäº®, <1å˜æš—, 1.0åŽŸå§‹
  "output_path": "path/to/bright.jpg"  // å¯é€‰
}
```

### 6. adjust-saturation - è°ƒæ•´é¥±å’Œåº¦
```json
{
  "file_path": "path/to/image.jpg",
  "factor": 0.8,  // >1å¢žå¼º, <1å‡å¼±, 0ç°åº¦, 1.0åŽŸå§‹
  "output_path": "path/to/saturated.jpg"  // å¯é€‰
}
```

### 7. apply-filter - åº”ç”¨æ»¤é•œ
```json
{
  "file_path": "path/to/image.jpg",
  "filter_type": "BLUR",  // è§ä¸Šæ–¹æ»¤é•œåˆ—è¡¨
  "output_path": "path/to/filtered.jpg"  // å¯é€‰
}
```

### 8. flip-image - ç¿»è½¬å›¾ç‰‡
```json
{
  "file_path": "path/to/image.jpg",
  "direction": "horizontal",  // horizontal, vertical
  "output_path": "path/to/flipped.jpg"  // å¯é€‰
}
```

### 9. convert-format - è½¬æ¢æ ¼å¼
```json
{
  "file_path": "path/to/image.png",
  "format": "JPEG",
  "quality": 95,  // JPEGè´¨é‡ 1-100
  "output_path": "path/to/converted.jpg"  // å¯é€‰
}
```

### 10. get-image-info - èŽ·å–å›¾ç‰‡ä¿¡æ¯
```json
{
  "file_path": "path/to/image.jpg"
}
```

### 11. create-thumbnail - åˆ›å»ºç¼©ç•¥å›¾
```json
{
  "file_path": "path/to/image.jpg",
  "size": 128,  // æœ€å¤§å°ºå¯¸
  "output_path": "path/to/thumbnail.jpg"  // å¯é€‰
}
```

### 12. add-watermark - æ·»åŠ æ°´å°
```json
{
  "file_path": "path/to/image.jpg",
  "watermark_text": "ç‰ˆæƒæ‰€æœ‰",
  "position": "bottom-right",  // top-left, top-right, bottom-left, bottom-right, center
  "opacity": 0.7,  // é€æ˜Žåº¦ 0.0-1.0
  "font_size": 36,
  "output_path": "path/to/watermarked.jpg"  // å¯é€‰
}
```

## ä½¿ç”¨ç¤ºä¾‹

### å¯åŠ¨æœåŠ¡å™¨
```bash
python src/server.py
```

### ä½¿ç”¨ uv å¯åŠ¨
```bash
uv run python src/server.py
```

### åœ¨MCPå®¢æˆ·ç«¯ä¸­ä½¿ç”¨
é…ç½®å®ŒæˆåŽï¼Œæ‚¨å¯ä»¥åœ¨æ”¯æŒMCPçš„åº”ç”¨ç¨‹åºï¼ˆå¦‚Claude Desktopï¼‰ä¸­ç›´æŽ¥ä½¿ç”¨å›¾åƒå¤„ç†åŠŸèƒ½ï¼š

1. **è£å‰ªå›¾ç‰‡**: ä½¿ç”¨ `crop-image` å·¥å…·ç²¾ç¡®è£å‰ªå›¾ç‰‡åŒºåŸŸ
2. **è°ƒæ•´å¤§å°**: ä½¿ç”¨ `resize-image` å·¥å…·æ™ºèƒ½ç¼©æ”¾å›¾ç‰‡
3. **åº”ç”¨æ»¤é•œ**: ä½¿ç”¨ `apply-filter` å·¥å…·ä¸ºå›¾ç‰‡æ·»åŠ å„ç§è§†è§‰æ•ˆæžœ
4. **æ ¼å¼è½¬æ¢**: ä½¿ç”¨ `convert-format` å·¥å…·åœ¨ä¸åŒå›¾ç‰‡æ ¼å¼é—´è½¬æ¢
5. **æ·»åŠ æ°´å°**: ä½¿ç”¨ `add-watermark` å·¥å…·ä¸ºå›¾ç‰‡æ·»åŠ æ–‡å­—æ°´å°

æ‰€æœ‰å·¥å…·éƒ½æ”¯æŒè‡ªåŠ¨ç”Ÿæˆè¾“å‡ºæ–‡ä»¶åï¼Œæˆ–è€…æ‚¨å¯ä»¥æŒ‡å®šè‡ªå®šä¹‰çš„è¾“å‡ºè·¯å¾„ã€‚

## æŠ€æœ¯ç‰¹æ€§

### ç¼“å­˜æœºåˆ¶
- è‡ªåŠ¨ç¼“å­˜æœ€è¿‘ä½¿ç”¨çš„å›¾ç‰‡
- å†…å­˜ä½¿ç”¨çŽ‡ç›‘æŽ§
- å®šæœŸæ¸…ç†è¿‡æœŸç¼“å­˜
- æ”¯æŒæ‰‹åŠ¨æ¸…ç†ç¼“å­˜

### é”™è¯¯å¤„ç†
- å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯åé¦ˆ
- è‡ªåŠ¨æ¢å¤å’Œé‡è¯•æœºåˆ¶

### æ€§èƒ½ä¼˜åŒ–
- å¤šçº¿ç¨‹å¹¶å‘å¤„ç†
- æ™ºèƒ½å†…å­˜ç®¡ç†
- é«˜æ•ˆçš„å›¾ç‰‡å¤„ç†ç®—æ³•
- æ”¯æŒå¤§æ–‡ä»¶å¤„ç†

## æ–‡ä»¶ç»“æž„

```
image-processing-toolkits/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ server.py          # ä¸»MCPæœåŠ¡å™¨æ–‡ä»¶
â”œâ”€â”€ LICENSE                # è®¸å¯è¯æ–‡ä»¶
â”œâ”€â”€ pyproject.toml         # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md             # é¡¹ç›®æ–‡æ¡£ï¼ˆæœ¬æ–‡æ¡£ï¼‰
```

## æ³¨æ„äº‹é¡¹

1. **ä¾èµ–å®‰è£…**: ç¡®ä¿æ‰€æœ‰ä¾èµ–åŒ…éƒ½å·²æ­£ç¡®å®‰è£…
2. **æ–‡ä»¶è·¯å¾„**: ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹äºŽå½“å‰å·¥ä½œç›®å½•çš„è·¯å¾„
3. **å›¾ç‰‡æ ¼å¼**: æ”¯æŒå¸¸è§çš„å›¾ç‰‡æ ¼å¼ (JPEG, PNG, BMP, TIFF, WEBP)
4. **å†…å­˜ä½¿ç”¨**: å¤„ç†å¤§å›¾ç‰‡æ—¶æ³¨æ„å†…å­˜ä½¿ç”¨æƒ…å†µ
5. **è¾“å‡ºè·¯å¾„**: å¦‚æžœä¸æŒ‡å®šè¾“å‡ºè·¯å¾„ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆå¸¦åŽç¼€çš„æ–‡ä»¶å

## æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **PILå¯¼å…¥å¤±è´¥**
   ```bash
   pip install Pillow --upgrade
   ```

2. **OpenCVå¯¼å…¥å¤±è´¥**
   ```bash
   pip install opencv-python --upgrade
   ```

3. **å†…å­˜ä¸è¶³**
   - å‡å°‘ç¼“å­˜å¤§å°
   - å¤„ç†è¾ƒå°çš„å›¾ç‰‡
   - æ‰‹åŠ¨æ¸…ç†ç¼“å­˜

4. **å­—ä½“åŠ è½½å¤±è´¥**
   - æ°´å°åŠŸèƒ½ä¼šè‡ªåŠ¨å›žé€€åˆ°é»˜è®¤å­—ä½“
   - å¯ä»¥æ‰‹åŠ¨æŒ‡å®šå­—ä½“è·¯å¾„

## æ‰©å±•åŠŸèƒ½

è¿™ä¸ªå›¾ç‰‡å¤„ç†æœåŠ¡å™¨é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯ä»¥è½»æ¾æ·»åŠ æ–°çš„åŠŸèƒ½ï¼š

1. **æ–°å¢žæ»¤é•œ**: åœ¨ `apply_filter` å‡½æ•°ä¸­æ·»åŠ æ–°çš„æ»¤é•œç±»åž‹
2. **è‡ªå®šä¹‰å¤„ç†**: åˆ›å»ºæ–°çš„å¤„ç†å‡½æ•°å¹¶æ³¨å†Œä¸ºå·¥å…·
3. **æ ¼å¼æ”¯æŒ**: æ‰©å±•æ”¯æŒçš„å›¾ç‰‡æ ¼å¼
4. **æ‰¹é‡å¤„ç†**: æ·»åŠ æ‰¹é‡å¤„ç†åŠŸèƒ½

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## è´¡çŒ®

æ¬¢è¿Žæäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼
